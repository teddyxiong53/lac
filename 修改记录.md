# cjson

这个不用写，但是以编译这个为入口，把autotools的编译链接过程走通。

现在可以编译通过。但是生成的只有la结尾的文件。没有看到a或者so文件。

C语言切分字符串

https://blog.csdn.net/SweeNeil/article/details/84787945

```
char *strtok_r(char *str, const char *delim, char **saveptr);
```

这个才是线程安全的。

测试代码：

```
#include <stdio.h>
#include <string.h>

int main()
{
    char str[] = "system.audio.volume";
    char* ptr;
    char* p;
    printf("before strtok:  str=%s\n", str);
    printf("begin:\n");
    ptr = strtok_r(str, ".", &p);
    while (ptr != NULL) {
        printf("str=%s\n", str);
        printf("ptr=%s\n", ptr);
        ptr = strtok_r(NULL, ".", &p);
    }
    return 0;
}
```

这样打印出来是：

```
before strtok:  str=system.audio.volume
begin:
str=system
ptr=system
str=system
ptr=audio
str=system
ptr=volume
```

那我以ptr的作为取值对象。

代码这样：

```
#include <stdio.h>
#include <string.h>

int main()
{
    char str[] = "system.audio.volume";
    char* ptr;
    char* p;
    printf("before strtok:  str=%s\n", str);
    ptr = strtok_r(str, ".", &p);
    while (ptr != NULL) {
        printf("ptr=%s\n", ptr);
        ptr = strtok_r(NULL, ".", &p);
    }
    return 0;
}
```

写入的时候，进行truncate操作。前面会有一堆的NUL。